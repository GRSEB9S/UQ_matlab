%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function [varHDMR] = get_variance(Sol, PC, nint, Nt, index_retain)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

PsiSqNorm=PC.PsiSqNorm;
tmp=zeros(nint,Nt);
szSol=size(Sol,1);
for j=2:szSol
    if index_retain(j) ~= 0
        tmp=tmp+(PsiSqNorm(j))*(Sol{j}).^2;
    end
end
varHDMR=tmp;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%